# 社内名刺管理システム

## プロジェクト概要
- **名前**: Business Cards Manager
- **目標**: 社内での名刺共有・管理を効率的に行うWebアプリケーション
- **主要機能**: 
  - 名刺のCRUD操作（作成・表示・更新・削除）
  - **名刺画像のアップロード・表示・削除**
  - **シンプルな名前・会社名検索機能**
  - タグ機能による分類

## URLs
- **本番環境**: https://e9697613.meisiver2.pages.dev
- **開発環境**: https://3000-i184visbb280hl2m4a86g-6532622b.e2b.dev（D1データベース対応）
- **GitHub**: https://github.com/071230e-ai/-Ver2
- **API Base**: https://e9697613.meisiver2.pages.dev/api

## 完成済み機能

### ✅ データベース設計
- **business_cards テーブル**: 名刺基本情報
- **tags テーブル**: タグ管理
- **business_card_tags テーブル**: 名刺とタグの関連
- **FTS5 仮想テーブル**: 全文検索対応

### ✅ API エンドポイント
| エンドポイント | メソッド | 説明 |
|---|---|---|
| `/api/cards` | GET | 名刺一覧取得（検索・フィルタリング対応） |
| `/api/cards/:id` | GET | 特定の名刺取得 |
| `/api/cards` | POST | 新規名刺登録 |
| `/api/cards/:id` | PUT | 名刺更新 |
| `/api/cards/:id` | DELETE | 名刺削除 |
| `/api/cards/:id/image` | POST | 名刺画像アップロード |
| `/api/cards/:id/image` | DELETE | 名刺画像削除 |
| `/api/images/:filename` | GET | 画像ファイル取得 |
| `/api/tags` | GET | タグ一覧取得 |

### ✅ フロントエンド機能
- レスポンシブデザイン（TailwindCSS）
- 名刺カード表示・編集・削除
- **画像アップロード機能（ドラッグ&ドロップ対応）**
- **画像プレビュー・削除機能**
- **名刺カードでの画像表示**
- モーダルベースの名刺登録・編集
- リアルタイム検索・フィルタリング
- タグ機能
- エラーハンドリング・通知機能

### ✅ 検索機能
- **名前・会社名・タグによる検索**（FTS5全文検索 + LIKE検索のハイブリッド）
- **ひらがな検索対応**（「たなか」で「田中」、「えいぎょう」で「営業」タグがヒット）
- **カタカナ・ひらがな相互変換**
- **一般的な日本人名・企業名・タグ名の読み対応**
- **検索クリア機能**
- 結果の並び替え（新着順）

## データアーキテクチャ
- **データモデル**: 正規化されたリレーショナル設計
- **ストレージサービス**: 
  - **開発環境**: Cloudflare D1 SQLite データベース（ローカル）✅
  - **本番環境**: インメモリストレージ（一時的）
  - **将来**: Cloudflare D1 + R2 Object Storage（本番環境）
- **検索機能**: 
  - **開発環境**: FTS5 全文検索 + ひらがな変換対応 ✅
  - **本番環境**: 文字列マッチング（一時的）
- **データフロー**: Frontend → Hono API → D1 Database（開発）/ インメモリ（本番）

## ユーザーガイド

### 基本操作
1. **名刺一覧表示**: トップページで全ての名刺を確認
2. **新規登録**: 「新規登録」ボタンから名刺情報を入力
3. **画像アップロード**: 名刺登録・編集時に画像をアップロード（ドラッグ&ドロップ対応）
4. **検索**: 検索ボックスで氏名・会社名・タグを入力して検索
   - **ひらがな検索**: 「たなか」「さとう」「やまだ」など
   - **漢字検索**: 「田中」「佐藤」「山田」など
   - **会社名検索**: 「てっく」で「テック」をヒット
   - **タグ検索**: 「えいぎょう」で「営業」タグ、「ぎじゅつ」で「技術」タグをヒット
5. **検索クリア**: クリアボタンで検索をリセット
6. **編集**: 各名刺カードの編集ボタンをクリック（編集時のみ削除可能）
   - **画像削除**: 編集画面で画像削除ボタンを使用
   - **名刺削除**: 編集画面で名刺削除ボタンを使用（確認あり）

### 高度な機能
- **タグ機能**: 名刺にタグを追加してカテゴライズ
- **日本語対応検索**: ひらがな・カタカナ・漢字の相互検索対応（名前・会社名・タグすべて対応）
- **インテリジェント検索**: 一般的な日本人名・企業名・タグの読み仮名辞書内蔵
- **ハイブリッド検索**: FTS5全文検索とLIKE検索を組み合わせた高精度検索
- **画像管理**: JPG、PNG、GIF対応（最大5MB）
- **セキュアな削除**: 削除操作は編集時のみに制限（誤削除防止）

### 必須入力項目
- **氏名**: 必須
- **会社名**: 必須
- その他の項目は任意

## 技術仕様

### 開発環境
- **プラットフォーム**: Cloudflare Pages + Workers
- **フレームワーク**: Hono (TypeScript)
- **データベース**: Cloudflare D1 (SQLite)
- **フロントエンド**: Vanilla JavaScript + TailwindCSS
- **デプロイ**: Wrangler CLI

### 未実装機能

#### 🔄 認証・ユーザー管理
- **ユーザー登録・ログイン機能**
- **アクセス制御**: ユーザー別アクセス権限
- **実装優先度**: 低

#### 🔄 エクスポート機能
- **CSV エクスポート**: 名刺データのCSV出力
- **名刺印刷**: PDFでの名刺出力
- **実装優先度**: 低

## 推奨される次のステップ

### 優先度: 高（進行中）
1. **Cloudflare Pages デプロイ** 🔄
   - 本番環境デプロイ完了
   - インメモリストレージ機能実装済み（デプロイ待ち）
   - D1データベース設定は一時的にコメントアウト

### 優先度: 中（完了済み）
2. **GitHub連携** ✅
   - GitHubリポジトリ作成・コード push 完了
   - 継続的なバージョン管理体制構築

### 優先度: 低  
3. **機能拡張**
   - ユーザー認証機能
   - エクスポート機能
   - 名刺画像OCR機能

## デプロイメント
- **ステータス**: ✅ 本番環境（Cloudflare Pages）で稼働中
- **技術スタック**: Hono + TypeScript + TailwindCSS + Cloudflare Pages + Cloudflare D1
- **プロジェクト名**: meisiver2
- **本番URL**: https://e9697613.meisiver2.pages.dev
- **開発URL**: https://3000-i184visbb280hl2m4a86g-6532622b.e2b.dev（D1データベース対応）
- **最終更新**: 2025-09-09

### 環境別機能状況
| 機能 | 開発環境 | 本番環境 |
|---|---|---|
| D1データベース | ✅ 完全対応 | ⚠️ 設定待ち |
| 名刺CRUD操作 | ✅ 永続化 | ⚠️ 一時的 |
| 全文検索 | ✅ FTS5対応 | ⚠️ 文字列マッチ |
| ひらがな検索 | ✅ 完全対応 | ✅ 完全対応 |
| タグ機能 | ✅ DB保存 | ⚠️ 一時的 |
| 画像アップロード | ✅ ローカル保存 | ✅ 一時的保存 |

## 開発コマンド

```bash
# ローカル開発
npm run build                    # アプリケーションをビルド
pm2 start ecosystem.config.cjs   # PM2で開発サーバー起動
npm run test                     # アプリケーションテスト

# データベース
npm run db:migrate:local         # ローカルマイグレーション適用
npm run db:seed                  # サンプルデータ投入
npm run db:reset                 # データベースリセット
npm run db:console:local         # ローカルDB コンソール

# デプロイ
npm run deploy                   # Cloudflare Pages にデプロイ
```

## サンプルデータ
システムには以下のサンプル名刺が登録済みです：
- 田中 太郎（株式会社テックソリューション - 営業部長）
- 佐藤 花子（合同会社イノベート - CTO）  
- 山田 次郎（有限会社デザインワークス - デザイナー）
- 鈴木 美咲（株式会社マーケティングプロ - マネージャー）
- 高橋 健一（個人事業主 - フリーランス）

各名刺にはタグが設定されており、検索・フィルタリング機能をテストできます。